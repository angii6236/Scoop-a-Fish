<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goldfish Scoop: Ocean Adventure</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Comic Sans MS', sans-serif;
      background: linear-gradient(#0099ff, #003366);
    }

    canvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(to top, #003366, #0099ff);
    }

    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-weight: bold;
      text-shadow: 2px 2px 4px #000;
    }

    #menu, #gameOver, #pauseMenu {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,50,0.85);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      text-align: center;
    }

    button {
      padding: 10px 20px;
      margin-top: 20px;
      border: none;
      border-radius: 10px;
      background: #00bfff;
      color: white;
      font-size: 20px;
      cursor: pointer;
    }

    button:hover {
      background: #0088cc;
    }

    #pauseBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 10px 15px;
      border-radius: 10px;
      font-size: 16px;
      border: none;
      background: #ffcc00;
      color: #333;
      cursor: pointer;
      font-weight: bold;
    }

    #pauseBtn:hover {
      background: #ff9900;
    }
  </style>
</head>
<body>
  <div id="ui">
    ‚ù§Ô∏è Durability: <span id="dur">100</span> |
    üí∞ Score: <span id="score">0</span> |
    ‚è∞ Time: <span id="time">60</span>
  </div>

  <button id="pauseBtn" onclick="pauseGame()">‚è∏Ô∏è Pause</button>

  <div id="menu">
    <h1>üê† Goldfish Scoop: Ocean Adventure üê†</h1>
    <p>Catch the fish, avoid the bombs!<br>Tap or click to scoop!</p>
    <button onclick="startGame()">Start Game</button>
  </div>

  <div id="pauseMenu" style="display:none;">
    <h2>Game Paused</h2>
    <button onclick="resumeGame()">‚ñ∂Ô∏è Resume</button>
    <button onclick="restartGame()">üîÑ Restart</button>
    <button onclick="goHome()">üè† Home</button>
  </div>

  <div id="gameOver" style="display:none;">
    <h2>Game Over!</h2>
    <p>Your Score: <span id="finalScore"></span></p>
    <p>üèÜ Best Score: <span id="bestScore"></span></p>
    <button onclick="restartGame()">Play Again</button>
    <button onclick="goHome()">Home</button>
  </div>

  <canvas id="gameCanvas" width="800" height="500"></canvas>

  <audio id="splashSound" src="https://actions.google.com/sounds/v1/water/splashing.ogg"></audio>
  <audio id="catchSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
  <audio id="bombSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
  <audio id="bgMusic" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_1b1e9c2c6e.mp3?filename=calm-sea-waves-ambient-110274.mp3" loop></audio>

  <script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  let fishes = [];
  let bombs = [];
  let bubbles = [];
  let decos = [];
  let splashes = [];
  let score = 0;
  let timeLeft = 60;
  let durability = 100;
  let running = false;
  let paused = false;

  const splashSound = document.getElementById("splashSound");
  const catchSound = document.getElementById("catchSound");
  const bombSound = document.getElementById("bombSound");
  const bgMusic = document.getElementById("bgMusic");

  // Start the game
  function startGame() {
    document.getElementById("menu").style.display = "none";
    document.getElementById("gameOver").style.display = "none";
    document.getElementById("pauseMenu").style.display = "none";
    fishes = [];
    bombs = [];
    bubbles = [];
    decos = [];
    splashes = [];
    score = 0;
    timeLeft = 60;
    durability = 100;
    paused = false;
    running = true;
    bgMusic.play().catch(()=>{});
    spawnObjects();
    gameLoop();
    startTimer();
    createDecos();
  }

  // Restart
  function restartGame() {
    startGame();
  }

  // Go back to home
  function goHome() {
    document.getElementById("menu").style.display = "flex";
    document.getElementById("gameOver").style.display = "none";
    document.getElementById("pauseMenu").style.display = "none";
    running = false;
    bgMusic.pause();
  }

  // Pause and resume
  function pauseGame() {
    if (!running) return;
    paused = true;
    running = false;
    bgMusic.pause();
    document.getElementById("pauseMenu").style.display = "flex";
  }

  function resumeGame() {
    paused = false;
    running = true;
    bgMusic.play().catch(()=>{});
    document.getElementById("pauseMenu").style.display = "none";
    gameLoop();
  }

  // Decorations (natural seaweed & coral)
  function createDecos() {
    decos = [];
    for (let i = 0; i < 14; i++) {
      const type = Math.random() > 0.6 ? 'coral' : 'seaweed';
      const x = i * (canvas.width / 14) + (Math.random() * 40 - 20);
      decos.push({
        type,
        x,
        baseY: 460 + Math.random() * 10,
        height: 50 + Math.random() * 80,
        sway: Math.random() * 0.5 + 0.2,
        color: type === 'coral' ? (Math.random() > 0.5 ? '#ff6f61' : '#ff8c42') : (Math.random() > 0.5 ? '#2e8b57' : '#1e7a3a'),
        detail: Math.random()
      });
    }
  }

  function drawSeaweed(d) {
    ctx.save();
    ctx.translate(d.x, d.baseY);
    const segments = 6;
    ctx.beginPath();
    ctx.moveTo(0, 0);
    for (let i = 1; i <= segments; i++) {
      const t = i / segments;
      const sway = Math.sin((Date.now() / 700 + d.x) * 0.005) * (d.sway * 30) * (1 - t);
      const cx = sway + (Math.random()-0.5)*3;
      const cy = -t * d.height;
      ctx.quadraticCurveTo(cx, cy + 10, cx*0.6, cy);
    }
    ctx.lineWidth = 6;
    ctx.strokeStyle = d.color;
    ctx.lineCap = 'round';
    ctx.stroke();

    // fronds
    for (let i = 0; i < 5; i++) {
      const t = (i+1) / 6;
      ctx.beginPath();
      const sx = Math.sin(i + d.x) * 2;
      const sy = -t * d.height;
      ctx.moveTo(sx, sy);
      ctx.quadraticCurveTo(sx + 15, sy - 10, sx + 5, sy - 30);
      ctx.strokeStyle = lighten(d.color, 0.1);
      ctx.lineWidth = 3;
      ctx.stroke();
    }

    ctx.restore();
  }

  function drawCoral(d) {
    ctx.save();
    ctx.translate(d.x, d.baseY);
    ctx.fillStyle = d.color;
    const branches = 5 + Math.floor(d.detail * 6);
    for (let i = 0; i < branches; i++) {
      const angle = -Math.PI/2 + (i - branches/2) * 0.25 + (Math.random()-0.5)*0.2;
      const len = d.height * (0.3 + Math.random() * 0.9);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      const cx = Math.cos(angle) * len * 0.6;
      const cy = Math.sin(angle) * len * 0.6;
      ctx.quadraticCurveTo(cx/2, cy/2 - 10, Math.cos(angle) * len, Math.sin(angle) * len);
      ctx.lineTo(Math.cos(angle) * len - 6, Math.sin(angle) * len + 6);
      ctx.quadraticCurveTo(cx/2, cy/2, 0, 0);
      ctx.fill();
    }
    // small dots
    for (let j = 0; j < 12; j++) {
      ctx.beginPath();
      const rx = (Math.random()-0.5) * d.height * 0.6;
      const ry = -Math.random() * d.height;
      ctx.arc(rx, ry, 3, 0, Math.PI*2);
      ctx.fillStyle = lighten(d.color, -0.05);
      ctx.fill();
    }
    ctx.restore();
  }

  function lighten(hex, amt) {
    try {
      const ctxTemp = document.createElement('canvas').getContext('2d');
      ctxTemp.fillStyle = hex;
      const rgb = ctxTemp.fillStyle.match(/\d+/g).map(Number);
      const r = Math.min(255, Math.max(0, rgb[0] + Math.round(255*amt)));
      const g = Math.min(255, Math.max(0, rgb[1] + Math.round(255*amt)));
      const b = Math.min(255, Math.max(0, rgb[2] + Math.round(255*amt)));
      return `rgb(${r},${g},${b})`;
    } catch (e) {
      return hex;
    }
  }

  // Object spawner
  function spawnObjects() {
    setInterval(() => {
      if (running) {
        if (Math.random() < 0.8)
          fishes.push({ x: 850, y: Math.random() * 400 + 40, speed: 1.5 + Math.random() * 2.5, img: "üê†" });
        else
          bombs.push({ x: 850, y: Math.random() * 400 + 40, speed: 2 + Math.random() * 2 });
      }
    }, 1000);

    setInterval(() => {
      if (running)
        bubbles.push({ x: Math.random() * 800, y: 500, r: Math.random() * 5 + 2, speed: 0.8 + Math.random() * 0.6 });
    }, 300);
  }

  // Timer
  function startTimer() {
    const timer = setInterval(() => {
      if (!running) return clearInterval(timer);
      timeLeft--;
      document.getElementById("time").textContent = timeLeft;
      if (timeLeft <= 0 || durability <= 0) endGame();
    }, 1000);
  }

  // End Game
  function endGame() {
    running = false;
    bgMusic.pause();
    document.getElementById("finalScore").textContent = score;
    let best = localStorage.getItem("bestScore") || 0;
    if (score > best) localStorage.setItem("bestScore", score);
    document.getElementById("bestScore").textContent = localStorage.getItem("bestScore");
    document.getElementById("gameOver").style.display = "flex";
  }

  // Game Loop
  function gameLoop() {
    if (!running) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Sea floor
    ctx.fillStyle = "#004466";
    ctx.fillRect(0, 460, 800, 50);

    // Decorations (natural)
    decos.forEach(d => {
      if (d.type === 'seaweed') drawSeaweed(d);
      else drawCoral(d);
    });

    // Bubbles (ambient)
    bubbles.forEach((b, i) => {
      ctx.beginPath();
      ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(255,255,255,0.5)";
      ctx.fill();
      b.y -= b.speed;
      b.x += Math.sin(Date.now() / 500 + b.x) * 0.2;
      if (b.y < 0) bubbles.splice(i, 1);
    });

    // Fishes (swimming left)
    for (let i = fishes.length - 1; i >= 0; i--) {
      const f = fishes[i];
      ctx.font = "30px Arial";
      ctx.fillText(f.img, f.x, f.y);
      f.x -= f.speed;
      if (f.x < -50) fishes.splice(i, 1);
    }

    // Bombs
    for (let i = bombs.length - 1; i >= 0; i--) {
      const b = bombs[i];
      ctx.font = "30px Arial";
      ctx.fillText("üí£", b.x, b.y);
      b.x -= b.speed;
      if (b.x < -50) bombs.splice(i, 1);
    }

    // Splashes / catch animations
    for (let i = splashes.length - 1; i >= 0; i--) {
      const s = splashes[i];
      for (let p of s.particles) {
        ctx.beginPath();
        ctx.fillStyle = `rgba(200,230,255,${p.alpha})`;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fill();
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.05; // gravity
        p.alpha -= 0.02;
      }
      s.life--;
      if (s.life <= 0) splashes.splice(i, 1);
    }

    requestAnimationFrame(gameLoop);
  }

  // Controls: clicking to catch fish or trigger bombs
  canvas.addEventListener("click", e => {
    if (!running) return;
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    // check fishes first (reverse to remove safely)
    for (let i = fishes.length - 1; i >= 0; i--) {
      const f = fishes[i];
      const dx = f.x - x;
      const dy = f.y - y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if (dist < 30) {
        // caught
        score += 10;
        document.getElementById("score").textContent = score;
        catchSound.play().catch(()=>{});
        createSplash(f.x, f.y);
        // also emit small bubbles
        for (let b = 0; b < 6; b++) {
          bubbles.push({ x: f.x + (Math.random()-0.5)*10, y: f.y, r: Math.random()*3+1, speed: 1 + Math.random() * 1.5 });
        }
        fishes.splice(i, 1);
        return; // one click one catch
      }
    }

    // check bombs
    for (let i = bombs.length - 1; i >= 0; i--) {
      const b = bombs[i];
      const dx = b.x - x;
      const dy = b.y - y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if (dist < 30) {
        durability -= 30;
        document.getElementById("dur").textContent = durability;
        bombSound.play().catch(()=>{});
        createExplosion(b.x, b.y);
        bombs.splice(i, 1);
        if (durability <= 0) endGame();
        return;
      }
    }
  });

  // mobile: tap
  canvas.addEventListener("touchend", e => {
    if (!running) return;
    const t = e.changedTouches[0];
    const rect = canvas.getBoundingClientRect();
    const x = t.clientX - rect.left;
    const y = t.clientY - rect.top;
    // reuse click logic by synthesizing an event-like object
    const evt = new MouseEvent('click', {clientX: t.clientX, clientY: t.clientY});
    canvas.dispatchEvent(evt);
  });

  // Splash / explosion helpers
  function createSplash(x, y) {
    splashSound.play().catch(()=>{});
    const particles = [];
    for (let i = 0; i < 12; i++) {
      const angle = Math.random() * Math.PI - Math.PI/2;
      const speed = 1 + Math.random() * 2.5;
      particles.push({
        x, y,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed - 1.5,
        r: Math.random()*3 + 1,
        alpha: 1
      });
    }
    splashes.push({ particles, life: 50 });
  }

  function createExplosion(x, y) {
    const particles = [];
    for (let i = 0; i < 10; i++) {
      const angle = Math.random() * Math.PI * 2;
      const speed = 1 + Math.random() * 3;
      particles.push({
        x, y,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed,
        r: Math.random()*4 + 1,
        alpha: 1
      });
    }
    splashes.push({ particles, life: 40 });
  }
  </script>
</body>
</html>
